<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUXE - פלטפורמת היכרויות יוקרתית</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --primary-gold: #D4AF37;
            --secondary-gold: #F7D794;
            --accent-gold: #FFE55C;
            --dark-navy: #0B1426;
            --medium-navy: #1A2332;
            --light-navy: #2A3441;
            --text-primary: #FFFFFF;
            --text-secondary: #B8C5D6;
            --text-muted: #6B7280;
            --success: #10B981;
            --error: #EF4444;
            --warning: #F59E0B;
            --border-color: rgba(212, 175, 55, 0.2);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--dark-navy) 0%, var(--medium-navy) 50%, var(--light-navy) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }

        /* Header Styles */
        .header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 20px 30px;
            margin: 20px 0 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, var(--primary-gold), var(--secondary-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-decoration: none;
            letter-spacing: -1px;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 10px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            color: var(--primary-gold);
            background: rgba(212, 175, 55, 0.1);
        }

        .nav-links a.active {
            color: var(--primary-gold);
        }

        /* Button Styles */
        .btn {
            background: linear-gradient(45deg, var(--primary-gold), var(--secondary-gold));
            color: var(--dark-navy);
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-gold);
            border: 2px solid var(--primary-gold);
        }

        .btn-outline:hover {
            background: var(--primary-gold);
            color: var(--dark-navy);
        }

        .btn-secondary {
            background: var(--glass-bg);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Content Sections */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 80px 0 120px 0;
            position: relative;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--text-primary), var(--primary-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .hero p {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Card Styles */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
        }

        /* Form Styles */
        .form-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-control::placeholder {
            color: var(--text-muted);
        }

        /* User Type Selection */
        .user-type-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .user-type-card {
            padding: 25px;
            border: 2px solid var(--border-color);
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--glass-bg);
        }

        .user-type-card:hover {
            border-color: var(--primary-gold);
            background: rgba(212, 175, 55, 0.1);
        }

        .user-type-card.selected {
            border-color: var(--primary-gold);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
        }

        .user-type-card h3 {
            color: var(--primary-gold);
            margin-bottom: 10px;
            font-size: 1.5rem;
        }

        .user-type-card p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Dashboard Layout */
        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr 280px;
            gap: 30px;
            margin: 30px 0;
        }

        .sidebar {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            height: fit-content;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .main-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* Profile Card */
        .profile-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .profile-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-gold), var(--secondary-gold));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .profile-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
        }

        .profile-card:hover::before {
            opacity: 1;
        }

        .profile-header {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
        }

        .profile-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-gold), var(--secondary-gold));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 24px;
            color: var(--dark-navy);
            position: relative;
            overflow: hidden;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .profile-info h3 {
            color: var(--text-primary);
            margin-bottom: 5px;
            font-size: 1.2rem;
        }

        .profile-info p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 5px;
        }

        .badge-verified {
            background: var(--success);
            color: white;
        }

        .badge-premium {
            background: linear-gradient(45deg, var(--primary-gold), var(--secondary-gold));
            color: var(--dark-navy);
        }

        .badge-online {
            background: var(--success);
            color: white;
        }

        /* Gallery Styles */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .gallery-item {
            aspect-ratio: 1;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .gallery-item:hover {
            transform: scale(1.03);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-item .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(212, 175, 55, 0.8), rgba(247, 215, 148, 0.8));
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-navy);
            font-weight: 600;
        }

        .gallery-item:hover .overlay {
            opacity: 1;
        }

        .upload-placeholder {
            aspect-ratio: 1;
            border: 2px dashed var(--border-color);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-muted);
        }

        .upload-placeholder:hover {
            border-color: var(--primary-gold);
            color: var(--primary-gold);
            background: rgba(212, 175, 55, 0.05);
        }

        /* Filter Styles */
        .filters {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Chat Styles */
        .chat-container {
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 18px;
            max-width: 70%;
            word-wrap: break-word;
        }

        .message.sent {
            background: linear-gradient(45deg, var(--primary-gold), var(--secondary-gold));
            color: var(--dark-navy);
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .message.received {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border-bottom-left-radius: 5px;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 18px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            color: var(--text-primary);
        }

        /* Admin Panel */
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-gold), var(--secondary-gold));
            color: var(--dark-navy);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .stat-card p {
            font-weight: 600;
            opacity: 0.8;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
        }

        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: var(--text-muted);
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--primary-gold);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 600;
            z-index: 1001;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .notification.success {
            background: var(--success);
            color: white;
        }

        .notification.error {
            background: var(--error);
            color: white;
        }

        /* Message Alert */
        .message-alert {
            position: fixed;
            top: 100px;
            right: 20px;
            max-width: 350px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--primary-gold);
            border-radius: 15px;
            padding: 20px;
            z-index: 1002;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.4s ease;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .message-alert.show {
            opacity: 1;
            transform: translateX(0);
        }

        .message-alert-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .message-alert-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-gold), var(--secondary-gold));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-navy);
            font-weight: 700;
            font-size: 16px;
        }

        .message-alert-content h4 {
            color: var(--primary-gold);
            margin: 0;
            font-size: 14px;
        }

        .message-alert-content p {
            color: var(--text-secondary);
            margin: 0;
            font-size: 12px;
        }

        .message-alert-text {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 14px;
            line-height: 1.4;
        }

        .message-alert-actions {
            display: flex;
            gap: 10px;
        }

        .message-alert-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .message-alert-btn.primary {
            background: linear-gradient(45deg, var(--primary-gold), var(--secondary-gold));
            color: var(--dark-navy);
        }

        .message-alert-btn.secondary {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .message-alert-btn:hover {
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .nav-links {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .hero p {
                font-size: 1.1rem;
            }
            
            .user-type-selector {
                grid-template-columns: 1fr;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
        }

        /* Loading Animation */
        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: calc(200px + 100%) 0; }
        }

        .loading {
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            background-size: 200px 100%;
            animation: shimmer 1.5s infinite;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--medium-navy);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-gold);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-gold);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <nav class="nav">
                <a href="#" class="logo" onclick="showSection('home')">LUXE</a>
                <div class="nav-links" id="nav-links" style="display: none;">
                    <a href="#" onclick="showSection('discover')" id="nav-discover">גלה</a>
                    <a href="#" onclick="showSection('messages')" id="nav-messages">הודעות</a>
                    <a href="#" onclick="showSection('gallery')" id="nav-gallery">גלריה</a>
                    <a href="#" onclick="showSection('profile')" id="nav-profile">פרופיל</a>
                    <a href="#" onclick="showSection('admin')" id="nav-admin" style="display: none;">ניהול</a>
                    <a href="#" onclick="logout()" id="nav-logout" style="display: none;">יציאה</a>
                </div>
                
                <!-- Storage Status (Development) -->
                <div id="storageStatus" style="display: none; font-size: 12px; color: var(--text-muted); margin-left: 20px;">
                    💾 <span id="storageInfo">טוען...</span>
                </div>
            </nav>
        </header>

        <!-- Home Section -->
        <section class="content-section active" id="home">
            <div class="hero">
                <div class="hero-content">
                    <h1>פלטפורמת היכרויות יוקרתית</h1>
                    <p>המקום שבו נפגשים אנשים מבוססים עם אנשים שמחפשים חוויות חיים ברמה גבוהה</p>
                    <div class="hero-buttons">
                        <button class="btn" onclick="showSection('register')">הצטרפות לקהילה</button>
                        <button class="btn btn-outline" onclick="showSection('login')">התחברות</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Registration Section -->
        <section class="content-section" id="register">
            <div class="form-container glass-card">
                <h2 style="text-align: center; margin-bottom: 30px; color: var(--primary-gold); font-size: 2rem;">הצטרפות לקהילה</h2>
                
                <div class="user-type-selector">
                    <div class="user-type-card" onclick="selectUserType('sugar_daddy')">
                        <h3>💼 שוגר דדי</h3>
                        <p>אני מבוסס/ת כלכלית ומחפש/ת להכיר אנשים מעניינים</p>
                    </div>
                    <div class="user-type-card" onclick="selectUserType('sugar_baby')">
                        <h3>✨ שוגר בייב</h3>
                        <p>אני מחפש/ת מישהו מבוסס לחוויות חיים משודרגות</p>
                    </div>
                </div>

                <form id="registerForm">
                    <div class="form-group">
                        <label>כינוי</label>
                        <input type="text" class="form-control" name="username" required placeholder="הכינוי שלך">
                    </div>

                    <div class="form-group">
                        <label>כתובת אימייל</label>
                        <input type="email" class="form-control" name="email" required placeholder="your@email.com">
                    </div>

                    <div class="form-group">
                        <label>סיסמה</label>
                        <input type="password" class="form-control" name="password" required placeholder="סיסמה חזקה">
                    </div>

                    <div class="form-group">
                        <label>גיל</label>
                        <input type="number" class="form-control" name="age" min="18" max="99" required placeholder="גילך">
                    </div>

                    <div class="form-group">
                        <label>מיקום</label>
                        <input type="text" class="form-control" name="location" required placeholder="עיר מגורים">
                    </div>

                    <div class="form-group">
                        <label>תיאור אישי</label>
                        <textarea class="form-control" name="bio" rows="4" placeholder="ספר/י משהו על עצמך..."></textarea>
                    </div>

                    <div id="sugarDaddyFields" style="display: none;">
                        <div class="form-group">
                            <label>מקצוע</label>
                            <input type="text" class="form-control" name="profession" placeholder="התחום המקצועי שלך">
                        </div>
                        <div class="form-group">
                            <label>ציפיות מהקשר</label>
                            <textarea class="form-control" name="expectations" rows="3" placeholder="מה אתה מחפש בקשר?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>סגנון חיים</label>
                            <textarea class="form-control" name="lifestyle" rows="3" placeholder="תאר את סגנון החיים שלך"></textarea>
                        </div>
                    </div>

                    <div id="sugarBabyFields" style="display: none;">
                        <div class="form-group">
                            <label>שאיפות</label>
                            <textarea class="form-control" name="aspirations" rows="3" placeholder="מה השאיפות שלך?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>מה אני מציע/ה לקשר</label>
                            <textarea class="form-control" name="offering" rows="3" placeholder="מה אתה יכול להביא לקשר?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>ציפיות לתמיכה</label>
                            <textarea class="form-control" name="support_expectations" rows="3" placeholder="איך אתה רואה את התמיכה?"></textarea>
                        </div>
                    </div>

                    <button type="submit" class="btn" style="width: 100%; margin-top: 20px;">הצטרפות לקהילה</button>
                </form>
            </div>
        </section>

        <!-- Login Section -->
        <section class="content-section" id="login">
            <div class="form-container glass-card">
                <h2 style="text-align: center; margin-bottom: 30px; color: var(--primary-gold); font-size: 2rem;">התחברות</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label>כתובת אימייל</label>
                        <input type="email" class="form-control" name="email" required placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label>סיסמה</label>
                        <input type="password" class="form-control" name="password" required placeholder="הסיסמה שלך">
                    </div>
                    <button type="submit" class="btn" style="width: 100%; margin-top: 20px;">התחברות</button>
                </form>
            </div>
        </section>

        <!-- Discover Section -->
        <section class="content-section" id="discover">
            <div class="dashboard">
                <aside class="sidebar">
                    <h3 style="color: var(--primary-gold); margin-bottom: 20px;">🔍 חיפוש וסינון</h3>
                    <div class="filters">
                        <div class="filter-group">
                            <label>סוג פרופיל</label>
                            <select class="form-control" id="userTypeFilter">
                                <option value="">הכל</option>
                                <option value="sugar_daddy">שוגר דדי</option>
                                <option value="sugar_baby">שוגר בייב</option>
                            </select>
                        </div>
                        <div class="filter-row">
                            <div class="filter-group">
                                <label>גיל מינימום</label>
                                <input type="number" class="form-control" id="minAge" min="18" max="99" placeholder="18">
                            </div>
                            <div class="filter-group">
                                <label>גיל מקסימום</label>
                                <input type="number" class="form-control" id="maxAge" min="18" max="99" placeholder="99">
                            </div>
                        </div>
                        <div class="filter-group">
                            <label>מיקום</label>
                            <input type="text" class="form-control" id="locationFilter" placeholder="עיר או אזור">
                        </div>
                        <div class="filter-group">
                            <label>סטטוס</label>
                            <select class="form-control" id="statusFilter">
                                <option value="">הכל</option>
                                <option value="online">מחובר כעת</option>
                                <option value="verified">מאומת</option>
                                <option value="premium">פרימיום</option>
                            </select>
                        </div>
                        <button class="btn" onclick="applyFilters()" style="width: 100%; margin-top: 15px;">חפש</button>
                    </div>
                </aside>

                <main class="main-content">
                    <h2 style="color: var(--primary-gold); margin-bottom: 20px;">חברי הקהילה</h2>
                    <div id="profilesContainer">
                        <!-- Dynamic content -->
                    </div>
                </main>

                <aside class="sidebar">
                    <h3 style="color: var(--primary-gold); margin-bottom: 20px;">👤 הפרופיל שלי</h3>
                    <div class="profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar" id="myAvatar">
                                <img id="myProfileImage" style="display: none;" />
                                <span id="myAvatarText">?</span>
                            </div>
                            <div class="profile-info">
                                <h3 id="myName">משתמש</h3>
                                <p id="myLocation">מיקום</p>
                            </div>
                        </div>
                        <button class="btn" onclick="showSection('profile')" style="width: 100%;">עריכת פרופיל</button>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4 style="color: var(--primary-gold); margin-bottom: 15px;">📊 סטטיסטיקות</h4>
                        <div style="background: rgba(255, 255, 255, 0.03); padding: 15px; border-radius: 10px;">
                            <p style="margin-bottom: 8px; color: var(--text-secondary);">צפיות בפרופיל: <span id="profileViews" style="color: var(--primary-gold);">0</span></p>
                            <p style="color: var(--text-secondary);">הודעות: <span id="messagesCount" style="color: var(--primary-gold);">0</span></p>
                        </div>
                    </div>
                </aside>
            </div>
        </section>

        <!-- Messages Section -->
        <section class="content-section" id="messages">
            <div class="dashboard">
                <aside class="sidebar">
                    <h3 style="color: var(--primary-gold); margin-bottom: 20px;">💬 השיחות שלי</h3>
                    <div id="chatList">
                        <!-- Dynamic content -->
                    </div>
                </aside>

                <main class="main-content">
                    <div class="chat-container" id="chatContainer">
                        <div class="chat-messages" id="chatMessages">
                            <div style="text-align: center; color: var(--text-muted); margin-top: 200px;">
                                <h3>💬 בחר שיחה</h3>
                                <p>בחר שיחה מהרשימה כדי להתחיל לשוחח</p>
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="text" id="messageInput" placeholder="הקלד הודעה..." disabled>
                            <button class="btn" onclick="sendMessage()" disabled id="sendBtn">שלח</button>
                        </div>
                    </div>
                </main>

                <aside class="sidebar">
                    <h3 style="color: var(--primary-gold); margin-bottom: 20px;">🌟 משתמשים פעילים</h3>
                    <div id="activeUsers">
                        <!-- Dynamic content -->
                    </div>
                </aside>
            </div>
        </section>

        <!-- Gallery Section -->
        <section class="content-section" id="gallery">
            <div class="form-container">
                <div class="glass-card">
                    <h2 style="color: var(--primary-gold); margin-bottom: 20px;">🖼️ הגלריה שלי</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">שתף את הרגעים המיוחדים שלך עם הקהילה</p>
                    
                    <h3 style="color: var(--text-primary); margin-bottom: 15px;">תמונות ציבוריות</h3>
                    <div class="gallery-grid" id="publicGallery">
                        <div class="upload-placeholder" onclick="uploadImage('public')">
                            <div style="font-size: 2rem; margin-bottom: 10px;">📷</div>
                            <div>הוסף תמונה ציבורית</div>
                        </div>
                    </div>
                    
                    <h3 style="color: var(--text-primary); margin: 30px 0 15px 0;">תמונות פרטיות</h3>
                    <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 15px;">תמונות שדורשות אישור צפייה</p>
                    <div class="gallery-grid" id="privateGallery">
                        <div class="upload-placeholder" onclick="uploadImage('private')">
                            <div style="font-size: 2rem; margin-bottom: 10px;">🔒</div>
                            <div>הוסף תמונה פרטית</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Profile Section -->
        <section class="content-section" id="profile">
            <div class="form-container glass-card">
                <h2 style="color: var(--primary-gold); margin-bottom: 30px; text-align: center;">⚙️ עריכת פרופיל</h2>
                
                <div style="text-align: center; margin-bottom: 30px;">
                    <div class="profile-avatar" style="width: 120px; height: 120px; margin: 0 auto 20px; font-size: 3rem;" onclick="uploadProfileImage()">
                        <img id="profileImagePreview" style="display: none;" />
                        <span id="profileAvatarText">📷</span>
                    </div>
                    <button class="btn btn-outline" onclick="uploadProfileImage()">החלף תמונת פרופיל</button>
                </div>
                
                <form id="profileForm">
                    <div class="form-group">
                        <label>כינוי</label>
                        <input type="text" class="form-control" id="profileUsername" name="username">
                    </div>
                    <div class="form-group">
                        <label>תיאור אישי</label>
                        <textarea class="form-control" id="profileBio" name="bio" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label>מיקום</label>
                        <input type="text" class="form-control" id="profileLocation" name="location">
                    </div>
                    
                    <div style="border-top: 1px solid var(--border-color); padding-top: 25px; margin-top: 25px;">
                        <h3 style="color: var(--primary-gold); margin-bottom: 20px;">🔐 אימות פרופיל</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">אמת את הפרופיל שלך כדי לקבל אמון נוסף מהקהילה</p>
                        <button type="button" class="btn btn-outline" onclick="startVerification()">התחל אימות</button>
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%; margin-top: 25px;">שמור שינויים</button>
                </form>
            </div>
        </section>

        <!-- Admin Section -->
        <section class="content-section" id="admin">
            <div class="glass-card">
                <h2 style="color: var(--primary-gold); margin-bottom: 30px;">🛠️ פאנל ניהול</h2>
                
                <div class="admin-stats">
                    <div class="stat-card">
                        <h3 id="totalUsers">0</h3>
                        <p>סה"כ משתמשים</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalSugarDaddies">0</h3>
                        <p>שוגר דדי</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalSugarBabies">0</h3>
                        <p>שוגר בייב</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalMessages">0</h3>
                        <p>הודעות</p>
                    </div>
                </div>

                <div style="display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap;">
                    <button class="btn" onclick="exportUsers()">📊 יצוא נתונים</button>
                    <button class="btn btn-outline" onclick="showReports()">📈 דוחות מפורטים</button>
                    <button class="btn btn-outline" onclick="manageReports()">🚨 ניהול דיווחים</button>
                </div>

                <div style="background: rgba(255, 255, 255, 0.03); padding: 25px; border-radius: 15px;">
                    <h3 style="color: var(--primary-gold); margin-bottom: 20px;">👥 ניהול משתמשים</h3>
                    <div id="usersList">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Modals -->
    <div id="verificationModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('verificationModal')">&times;</span>
            <h3 style="color: var(--primary-gold); margin-bottom: 20px;">🔐 אימות פרופיל</h3>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">כדי לאמת את הפרופיל שלך, אנא העלה תמונה ברורה של עצמך המוכיחה שאתה אמיתי.</p>
            <div class="form-group">
                <label>העלה תמונה לאימות</label>
                <input type="file" class="form-control" id="verificationImage" accept="image/*">
            </div>
            <button class="btn" onclick="submitVerification()">שלח לאימות</button>
        </div>
    </div>

    <div id="imageModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="modal-close" onclick="closeModal('imageModal')">&times;</span>
            <div id="imageModalContent">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>

    <div id="privateAccessModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('privateAccessModal')">&times;</span>
            <h3 style="color: var(--primary-gold); margin-bottom: 20px;">🔒 בקשת גישה לתמונות פרטיות</h3>
            <p style="color: var(--text-secondary); margin-bottom: 20px;" id="privateAccessText"></p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn" onclick="sendPrivateAccessRequest()">שלח בקשה</button>
                <button class="btn btn-outline" onclick="closeModal('privateAccessModal')">ביטול</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Message Alert -->
    <div class="message-alert" id="messageAlert">
        <div class="message-alert-header">
            <div class="message-alert-avatar" id="alertAvatar">
                <img id="alertAvatarImg" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%; display: none;" />
                <span id="alertAvatarText">?</span>
            </div>
            <div class="message-alert-content">
                <h4>הודעה חדשה</h4>
                <p id="alertSenderName">משתמש</p>
            </div>
        </div>
        <div class="message-alert-text" id="alertMessageText">
            תוכן ההודעה יופיע כאן
        </div>
        <div class="message-alert-actions">
            <button class="message-alert-btn primary" onclick="openAlertChat()">פתח שיחה</button>
            <button class="message-alert-btn secondary" onclick="dismissAlert()">סגור</button>
        </div>
    </div>

    <script>
        // Global State Management with Local Storage
        const AppState = {
            currentUser: null,
            users: [],
            messages: [],
            gallery: [],
            currentChat: null,
            selectedUserType: null,
            isAdmin: false,
            currentAlertSender: null, // For message alerts
            permissions: {
                canViewProfiles: true,
                canSendMessages: true,
                canUploadImages: true,
                canAccessPrivateGallery: false // Future premium feature
            }
        };

        // Local Storage Management
        const Storage = {
            keys: {
                users: 'luxe_users',
                messages: 'luxe_messages', 
                gallery: 'luxe_gallery',
                currentUser: 'luxe_current_user',
                appData: 'luxe_app_data'
            },

            save(key, data) {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (error) {
                    console.warn('Could not save to localStorage:', error);
                    return false;
                }
            },

            load(key, defaultValue = null) {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : defaultValue;
                } catch (error) {
                    console.warn('Could not load from localStorage:', error);
                    return defaultValue;
                }
            },

            remove(key) {
                try {
                    localStorage.removeItem(key);
                    return true;
                } catch (error) {
                    console.warn('Could not remove from localStorage:', error);
                    return false;
                }
            },

            clear() {
                try {
                    Object.values(this.keys).forEach(key => {
                        localStorage.removeItem(key);
                    });
                    return true;
                } catch (error) {
                    console.warn('Could not clear localStorage:', error);
                    return false;
                }
            }
        };

        // Save all app state to localStorage
        function saveAppState() {
            Storage.save(Storage.keys.users, AppState.users);
            Storage.save(Storage.keys.messages, AppState.messages);
            Storage.save(Storage.keys.gallery, AppState.gallery);
            
            // Save current user ID only (for security)
            if (AppState.currentUser) {
                Storage.save(Storage.keys.currentUser, {
                    id: AppState.currentUser.id,
                    email: AppState.currentUser.email
                });
            } else {
                Storage.remove(Storage.keys.currentUser);
            }
            
            updateStorageStatus(); // Update status display
            console.log('App state saved to localStorage');
        }

        // Load all app state from localStorage
        function loadAppState() {
            console.log('Loading app state from localStorage...');
            
            // Load users
            const savedUsers = Storage.load(Storage.keys.users, []);
            if (savedUsers.length > 0) {
                AppState.users = savedUsers;
                console.log(`Loaded ${savedUsers.length} users from storage`);
            } else {
                initializeDemoData();
                saveAppState(); // Save demo data for next time
            }
            
            // Ensure admin user exists
            ensureAdminExists();
            
            // Load messages
            AppState.messages = Storage.load(Storage.keys.messages, []);
            console.log(`Loaded ${AppState.messages.length} messages from storage`);
            
            // Load gallery
            AppState.gallery = Storage.load(Storage.keys.gallery, []);
            console.log(`Loaded ${AppState.gallery.length} gallery items from storage`);
            
            // Load current user
            const savedCurrentUser = Storage.load(Storage.keys.currentUser);
            if (savedCurrentUser) {
                const user = AppState.users.find(u => u.id === savedCurrentUser.id);
                if (user) {
                    AppState.currentUser = user;
                    AppState.isAdmin = (user.type === 'admin');
                    console.log(`Auto-logged in user: ${user.username}`);
                    
                    // Auto redirect to discover if logged in
                    setTimeout(() => {
                        updateUserInterface();
                        if (window.location.hash !== '#home') {
                            showSection('discover');
                        }
                    }, 100);
                }
            }
        }

        // Ensure admin user exists
        function ensureAdminExists() {
            const adminExists = AppState.users.find(u => u.type === 'admin');
            if (!adminExists) {
                const adminUser = {
                    id: 999,
                    username: "מנהל המערכת",
                    email: "admin@luxe.com",
                    type: "admin",
                    age: 30,
                    location: "מרכז",
                    bio: "מנהל מערכת LUXE",
                    verified: true,
                    premium: true,
                    online: true,
                    profileImage: "https://images.unsplash.com/photo-1560250097-0b93528c311a?w=300&h=300&fit=crop&crop=face",
                    joinDate: new Date()
                };
                AppState.users.push(adminUser);
                saveAppState();
                console.log('Admin user created');
            }
        }

        // Initialize Demo Data
        function initializeDemoData() {
            AppState.users = [
                {
                    id: 1,
                    username: "דוד כהן",
                    email: "david@luxe.com",
                    type: "sugar_daddy",
                    age: 38,
                    location: "תל אביב - רמת אביב",
                    bio: "יזם ומשקיע בתחום הטכנולוגיה. אוהב לטייל, לחוות דברים חדשים ולהכיר אנשים מעניינים עם חזון.",
                    profession: "מייסד ומנכ\"ל חברת טכנולוגיה",
                    expectations: "מחפש מישהי חכמה ושאפתנית לחלוק איתה חוויות חיים ייחודיות",
                    lifestyle: "סגנון חיים דינמי עם התמקדות בעסקים, נסיעות ותרבות",
                    verified: true,
                    premium: true,
                    online: true,
                    profileImage: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=300&h=300&fit=crop&crop=face",
                    profileViews: 245,
                    messagesCount: 18,
                    joinDate: new Date(2024, 0, 15)
                },
                {
                    id: 2,
                    username: "מאיה לוי",
                    email: "maya@luxe.com",
                    type: "sugar_baby",
                    age: 25,
                    location: "חיפה - כרמל",
                    bio: "סטודנטית לתואר שני בעיצוב אופנה, חולמת לפתוח מותג אופנה משלי. אוהבת אמנות, תרבות ונסיעות.",
                    aspirations: "לפתוח מותג אופנה בינלאומי ולהשפיע על עולם העיצוב",
                    offering: "יצירתיות, אנרגיה חיובית ונקודת מבט צעירה ומרעננת",
                    support_expectations: "חונכות עסקית, הזדמנויות רשת והשראה אישית",
                    verified: false,
                    premium: false,
                    online: true,
                    profileImage: "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=300&h=300&fit=crop&crop=face",
                    profileViews: 189,
                    messagesCount: 12,
                    joinDate: new Date(2024, 1, 8)
                },
                {
                    id: 3,
                    username: "אלכס רוזנברג",
                    email: "alex@luxe.com",
                    type: "sugar_daddy",
                    age: 44,
                    location: "ירושלים - רחביה",
                    bio: "עורך דין מוצלח ומשקיע נדל\"ן. אוהב יין איכותי, מסעדות משובחות ואמנות קלאסית.",
                    profession: "שותף בכיר במשרד עו\"ד בוטיק",
                    expectations: "מחפש מישהי עם טעם מעודן שתוכל להעריך את הדברים הטובים בחיים",
                    lifestyle: "אוהב יוקרה, תרבות גבוהה ונסיעות למקומות אקסקלוסיביים",
                    verified: true,
                    premium: true,
                    online: false,
                    profileImage: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=300&h=300&fit=crop&crop=face",
                    profileViews: 312,
                    messagesCount: 25,
                    joinDate: new Date(2023, 11, 3)
                },
                {
                    id: 4,
                    username: "נועה בר",
                    email: "noa@luxe.com",
                    type: "sugar_baby",
                    age: 23,
                    location: "תל אביב - נווה צדק",
                    bio: "רקדנית מקצועית ומורה לריקוד עכשווי. חולמת להקים להקת מחול משלי ולהופיע על במות בינלאומיות.",
                    aspirations: "להקים להקת מחול עכשווי ולזכות בהכרה בינלאומית",
                    offering: "אמנות, תנועה, ביטוי עצמי ואנרגיה יוצרת",
                    support_expectations: "תמיכה בפיתוח קריירה אמנותית ובחלום הבינלאומי",
                    verified: true,
                    premium: false,
                    online: true,
                    profileImage: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=300&h=300&fit=crop&crop=face",
                    profileViews: 156,
                    messagesCount: 9,
                    joinDate: new Date(2024, 2, 12)
                }
            ];

            // Admin user
            AppState.users.push({
                id: 999,
                username: "מנהל מערכת",
                email: "admin@luxe.com",
                type: "admin",
                verified: true,
                premium: true,
                online: true,
                profileImage: "https://images.unsplash.com/photo-1560250097-0b93528c311a?w=300&h=300&fit=crop&crop=face"
            });

            AppState.messages = [
                {
                    id: 1,
                    from: 1,
                    to: 2,
                    content: "היי מאיה, ראיתי את הפרופיל שלך והתרשמתי מהחזון שלך בעיצוב אופנה. אשמח להכיר ולשמוע עוד על הרעיונות שלך.",
                    timestamp: new Date(Date.now() - 3600000),
                    read: false
                },
                {
                    id: 2,
                    from: 2,
                    to: 1,
                    content: "היי דוד! תודה רבה, אני אשמח לשתף. יש לי כמה רעיונות מעניינים למותג אופנה בר-קיימא.",
                    timestamp: new Date(Date.now() - 1800000),
                    read: true
                },
                {
                    id: 3,
                    from: 3,
                    to: 4,
                    content: "נועה, הביצועים שלך נראים מדהימים. אשמח לדבר על אפשרויות להשקעה בקריירה האמנותית שלך.",
                    timestamp: new Date(Date.now() - 7200000),
                    read: false
                }
            ];

            AppState.gallery = [
                {
                    id: 1,
                    userId: 1,
                    imageUrl: 'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=400&fit=crop',
                    caption: 'נסיעה עסקים לסנטוריני',
                    isPrivate: false,
                    timestamp: new Date(Date.now() - 86400000)
                },
                {
                    id: 2,
                    userId: 2,
                    imageUrl: 'https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=400&fit=crop',
                    caption: 'מהקולקציה החדשה שלי',
                    isPrivate: false,
                    timestamp: new Date(Date.now() - 172800000)
                },
                {
                    id: 3,
                    userId: 1,
                    imageUrl: 'https://images.unsplash.com/photo-1574782900174-4f7d95b1f19b?w=400&h=400&fit=crop',
                    caption: 'ערב במסעדה משובחת',
                    isPrivate: true,
                    timestamp: new Date(Date.now() - 259200000)
                }
            ];

            console.log('Demo data initialized successfully');
        }

        // Authentication System
        function demoLogin(email) {
            console.log('=== DEMO LOGIN ATTEMPT ===');
            console.log('Email:', email);
            console.log('Users available:', AppState.users.length);
            console.log('User emails:', AppState.users.map(u => u.email));
            
            const user = AppState.users.find(u => u.email === email);
            console.log('Found user:', user);
            
            if (user) {
                AppState.currentUser = user;
                AppState.isAdmin = (user.type === 'admin');
                saveAppState(); // Save login state
                updateUserInterface();
                showSection('discover');
                showNotification(`ברוך הבא ${user.username}!`);
                console.log('Login successful for:', user.username, 'Admin:', AppState.isAdmin);
            } else {
                console.error('User not found!');
                showNotification('שגיאה בהתחברות - משתמש לא נמצא', 'error');
            }
        }

        // Hidden demo access for development (use in console)
        window.devLogin = function(type) {
            console.log('Dev login called with type:', type);
            
            const emails = {
                'daddy': 'david@luxe.com',
                'baby': 'maya@luxe.com', 
                'premium': 'alex@luxe.com',
                'admin': 'admin@luxe.com'
            };
            
            if (emails[type]) {
                console.log('Using email:', emails[type]);
                demoLogin(emails[type]);
            } else {
                console.log('Available types: daddy, baby, premium, admin');
                console.log('Available emails:', emails);
            }
        };

        // Force admin login (emergency function)
        window.forceAdminLogin = function() {
            ensureAdminExists();
            const admin = AppState.users.find(u => u.type === 'admin');
            if (admin) {
                AppState.currentUser = admin;
                AppState.isAdmin = true;
                saveAppState();
                updateUserInterface();
                showSection('admin');
                showNotification('התחברת כמנהל מערכת!');
                console.log('Force admin login successful');
            } else {
                console.error('Could not create admin user');
            }
        };

        // Clear all data (development function)
        window.clearAppData = function() {
            if (confirm('Are you sure you want to clear all app data? This cannot be undone.')) {
                Storage.clear();
                location.reload();
            }
        };

        // Show storage statistics (development function)
        window.showStorageInfo = function() {
            const users = Storage.load(Storage.keys.users, []);
            const messages = Storage.load(Storage.keys.messages, []);
            const gallery = Storage.load(Storage.keys.gallery, []);
            const currentUser = Storage.load(Storage.keys.currentUser);
            
            console.log('🗄️ Local Storage Details:');
            console.log(`Users: ${users.length} (${JSON.stringify(users).length} chars)`);
            console.log(`Messages: ${messages.length} (${JSON.stringify(messages).length} chars)`);
            console.log(`Gallery: ${gallery.length} (${JSON.stringify(gallery).length} chars)`);
            console.log(`Current User: ${currentUser ? currentUser.email : 'None'}`);
            
            console.log('\n👥 Available Users:');
            users.forEach(user => {
                console.log(`- ${user.email} (${user.type}) - ${user.username}`);
            });
            
            const totalSize = JSON.stringify({users, messages, gallery}).length;
            console.log(`\n📦 Total Size: ~${(totalSize / 1024).toFixed(2)} KB`);
        };

        // Debug current state
        window.debugState = function() {
            console.log('🔍 Current App State:');
            console.log('Current User:', AppState.currentUser);
            console.log('Is Admin:', AppState.isAdmin);
            console.log('Users Count:', AppState.users.length);
            console.log('Messages Count:', AppState.messages.length);
            console.log('Gallery Count:', AppState.gallery.length);
            
            console.log('\n📧 User Emails:');
            AppState.users.forEach(user => {
                console.log(`- ${user.email} (${user.type})`);
            });
        };

        // Quick login buttons in console
        window.quickLogin = function() {
            console.log('🚀 Quick Login Options:');
            console.log('Type one of these commands:');
            console.log('devLogin("admin")   - 🛠️ Admin');
            console.log('devLogin("daddy")   - 👨‍💼 Sugar Daddy');  
            console.log('devLogin("baby")    - ✨ Sugar Baby');
            console.log('devLogin("premium") - 💎 Premium User');
            console.log('\nOr use: forceAdminLogin() for emergency admin access');
        };

        // Update storage status display
        function updateStorageStatus() {
            const statusElement = document.getElementById('storageInfo');
            const storageStatus = document.getElementById('storageStatus');
            
            if (statusElement) {
                const users = Storage.load(Storage.keys.users, []).length;
                const messages = Storage.load(Storage.keys.messages, []).length;
                const gallery = Storage.load(Storage.keys.gallery, []).length;
                
                statusElement.textContent = `${users}👥 ${messages}💬 ${gallery}🖼️`;
                
                // Show storage status in development mode
                if (window.location.hash.includes('dev') || window.location.search.includes('dev')) {
                    storageStatus.style.display = 'block';
                }
            }
        }

        function logout() {
            AppState.currentUser = null;
            AppState.isAdmin = false;
            AppState.currentChat = null;
            saveAppState(); // Save logout state
            updateUserInterface();
            showSection('home');
            showNotification('התנתקת בהצלחה');
        }

        // User Interface Management
        function updateUserInterface() {
            const user = AppState.currentUser;
            
            // Update navigation visibility
            const navLinks = document.getElementById('nav-links');
            navLinks.style.display = user ? 'flex' : 'none';
            
            // Update navigation
            document.getElementById('nav-logout').style.display = user ? 'block' : 'none';
            document.getElementById('nav-admin').style.display = (user && AppState.isAdmin) ? 'block' : 'none';
            
            if (user) {
                // Update profile info
                document.getElementById('myName').textContent = user.username;
                document.getElementById('myLocation').textContent = user.location || 'לא צוין';
                document.getElementById('profileViews').textContent = user.profileViews || 0;
                document.getElementById('messagesCount').textContent = user.messagesCount || 0;
                
                // Update avatar
                const avatarImg = document.getElementById('myProfileImage');
                const avatarText = document.getElementById('myAvatarText');
                
                if (user.profileImage) {
                    avatarImg.src = user.profileImage;
                    avatarImg.style.display = 'block';
                    avatarText.style.display = 'none';
                } else {
                    avatarText.textContent = user.username[0].toUpperCase();
                    avatarImg.style.display = 'none';
                    avatarText.style.display = 'block';
                }
                
                // Update profile form
                if (document.getElementById('profileUsername')) {
                    document.getElementById('profileUsername').value = user.username;
                    document.getElementById('profileBio').value = user.bio || '';
                    document.getElementById('profileLocation').value = user.location || '';
                }
                
                // Update profile image preview
                const profilePreview = document.getElementById('profileImagePreview');
                const profileAvatarText = document.getElementById('profileAvatarText');
                
                if (user.profileImage && profilePreview) {
                    profilePreview.src = user.profileImage;
                    profilePreview.style.display = 'block';
                    profileAvatarText.style.display = 'none';
                } else if (profileAvatarText) {
                    profilePreview.style.display = 'none';
                    profileAvatarText.style.display = 'block';
                }
            }
        }

        // Section Navigation
        function showSection(sectionId) {
            // Check if user is logged in for protected sections
            if (!AppState.currentUser && ['discover', 'messages', 'gallery', 'profile', 'admin'].includes(sectionId)) {
                showNotification('אנא התחבר כדי לגשת לעמוד זה', 'error');
                showSection('login');
                return;
            }
            
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
                
                // Load section-specific content
                switch(sectionId) {
                    case 'discover':
                        loadProfiles();
                        break;
                    case 'messages':
                        loadMessages();
                        break;
                    case 'gallery':
                        loadGallery();
                        break;
                    case 'admin':
                        if (AppState.isAdmin) loadAdminPanel();
                        break;
                }
            }
        }

        // User Type Selection
        function selectUserType(type) {
            AppState.selectedUserType = type;
            
            // Update UI
            document.querySelectorAll('.user-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.user-type-card').classList.add('selected');
            
            // Show/hide specific fields
            const sugarDaddyFields = document.getElementById('sugarDaddyFields');
            const sugarBabyFields = document.getElementById('sugarBabyFields');
            
            if (type === 'sugar_daddy') {
                sugarDaddyFields.style.display = 'block';
                sugarBabyFields.style.display = 'none';
            } else {
                sugarBabyFields.style.display = 'block';
                sugarDaddyFields.style.display = 'none';
            }
        }

        // Profile Management
        function loadProfiles() {
            if (!AppState.currentUser) return;
            
            const container = document.getElementById('profilesContainer');
            container.innerHTML = '';
            
            const profiles = AppState.users.filter(user => 
                user.id !== AppState.currentUser.id && user.type !== 'admin'
            );
            
            profiles.forEach(user => {
                const card = createProfileCard(user);
                container.appendChild(card);
            });
        }

        function createProfileCard(user) {
            const card = document.createElement('div');
            card.className = 'profile-card';
            
            const userGallery = AppState.gallery.filter(img => img.userId === user.id && !img.isPrivate);
            const galleryPreview = userGallery.length > 0 ? 
                `<div style="display: flex; gap: 8px; margin-top: 15px;">
                    ${userGallery.slice(0, 3).map(img => 
                        `<img src="${img.imageUrl}" style="width: 50px; height: 50px; border-radius: 8px; object-fit: cover; cursor: pointer;" onclick="openImageModal(${img.id})">`
                    ).join('')}
                    ${userGallery.length > 3 ? `<div style="width: 50px; height: 50px; border-radius: 8px; background: var(--glass-bg); display: flex; align-items: center; justify-content: center; font-size: 12px; color: var(--text-muted);">+${userGallery.length - 3}</div>` : ''}
                </div>` : '';
            
            card.innerHTML = `
                <div class="profile-header">
                    <div class="profile-avatar">
                        ${user.profileImage ? 
                            `<img src="${user.profileImage}">` :
                            user.username[0].toUpperCase()
                        }
                    </div>
                    <div class="profile-info">
                        <h3>
                            ${user.username}
                            ${user.verified ? '<span class="badge badge-verified">✓ מאומת</span>' : ''}
                            ${user.premium ? '<span class="badge badge-premium">★ פרימיום</span>' : ''}
                        </h3>
                        <p>${user.age} • ${user.location}</p>
                        <p style="margin-top: 5px;">
                            ${user.online ? '<span class="badge badge-online">● מחובר</span>' : '<span style="color: var(--text-muted);">○ לא מחובר</span>'}
                        </p>
                        ${user.type === 'sugar_daddy' ? `<p style="color: var(--primary-gold); font-size: 12px; margin-top: 5px;">💼 ${user.profession}</p>` : ''}
                    </div>
                </div>
                <p style="margin: 15px 0; color: var(--text-secondary); line-height: 1.5;">${user.bio}</p>
                ${galleryPreview}
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn" style="flex: 1;" onclick="startChat(${user.id})">💬 שלח הודעה</button>
                    <button class="btn btn-outline" onclick="requestPrivateAccess(${user.id})">🔒 תמונות פרטיות</button>
                </div>
            `;
            
            return card;
        }

        // Messaging System
        function loadMessages() {
            if (!AppState.currentUser) return;
            
            loadChatList();
            loadActiveUsers();
        }

        function loadChatList() {
            const container = document.getElementById('chatList');
            container.innerHTML = '';
            
            const userChats = [...new Set(AppState.messages.filter(msg => 
                msg.from === AppState.currentUser.id || msg.to === AppState.currentUser.id
            ).map(msg => msg.from === AppState.currentUser.id ? msg.to : msg.from))];
            
            userChats.forEach(userId => {
                const user = AppState.users.find(u => u.id === userId);
                if (user) {
                    const lastMessage = AppState.messages.filter(msg => 
                        (msg.from === AppState.currentUser.id && msg.to === userId) ||
                        (msg.from === userId && msg.to === AppState.currentUser.id)
                    ).sort((a, b) => b.timestamp - a.timestamp)[0];
                    
                    const chatItem = document.createElement('div');
                    chatItem.className = 'profile-card';
                    chatItem.style.cursor = 'pointer';
                    chatItem.onclick = () => openChat(userId);
                    
                    chatItem.innerHTML = `
                        <div class="profile-header">
                            <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 16px;">
                                ${user.profileImage ? `<img src="${user.profileImage}">` : user.username[0].toUpperCase()}
                            </div>
                            <div class="profile-info">
                                <h3 style="font-size: 1rem;">${user.username}</h3>
                                <p style="font-size: 13px;">${lastMessage ? lastMessage.content.substring(0, 30) + '...' : 'התחל שיחה'}</p>
                                <p style="font-size: 11px; color: var(--text-muted);">${lastMessage ? formatTimestamp(lastMessage.timestamp) : ''}</p>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(chatItem);
                }
            });
        }

        function loadActiveUsers() {
            const container = document.getElementById('activeUsers');
            container.innerHTML = '';
            
            const activeUsers = AppState.users.filter(user => 
                user.id !== AppState.currentUser.id && 
                user.type !== 'admin' && 
                user.online
            );
            
            activeUsers.forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'profile-card';
                userItem.style.cursor = 'pointer';
                userItem.onclick = () => startChat(user.id);
                
                userItem.innerHTML = `
                    <div class="profile-header">
                        <div class="profile-avatar" style="width: 40px; height: 40px; font-size: 14px;">
                            ${user.profileImage ? `<img src="${user.profileImage}">` : user.username[0].toUpperCase()}
                        </div>
                        <div class="profile-info">
                            <h3 style="font-size: 0.9rem;">${user.username}</h3>
                            <p style="font-size: 11px; color: var(--success);">● מחובר כעת</p>
                        </div>
                    </div>
                `;
                
                container.appendChild(userItem);
            });
        }

        function startChat(userId) {
            openChat(userId);
            showSection('messages');
        }

        function openChat(userId) {
            AppState.currentChat = userId;
            const user = AppState.users.find(u => u.id === userId);
            
            if (!user) return;
            
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';
            
            // Chat header
            const header = document.createElement('div');
            header.style.cssText = 'padding: 15px; border-bottom: 1px solid var(--border-color); margin-bottom: 15px; display: flex; align-items: center; gap: 15px;';
            header.innerHTML = `
                <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 16px;">
                    ${user.profileImage ? `<img src="${user.profileImage}">` : user.username[0].toUpperCase()}
                </div>
                <div>
                    <h3 style="margin: 0; color: var(--primary-gold);">${user.username}</h3>
                    <p style="margin: 0; font-size: 14px; color: var(--text-secondary);">
                        ${user.online ? '🟢 מחובר כעת' : '⚪ לא מחובר'}
                    </p>
                </div>
            `;
            messagesContainer.appendChild(header);
            
            // Load messages
            const chatMsgs = AppState.messages.filter(msg => 
                (msg.from === AppState.currentUser.id && msg.to === userId) ||
                (msg.from === userId && msg.to === AppState.currentUser.id)
            ).sort((a, b) => a.timestamp - b.timestamp);
            
            chatMsgs.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${msg.from === AppState.currentUser.id ? 'sent' : 'received'}`;
                messageDiv.innerHTML = `
                    <div style="margin-bottom: 5px;">${msg.content}</div>
                    <div style="font-size: 11px; opacity: 0.7;">${formatTimestamp(msg.timestamp)}</div>
                `;
                messagesContainer.appendChild(messageDiv);
            });
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Enable input
            document.getElementById('messageInput').disabled = false;
            document.getElementById('sendBtn').disabled = false;
        }

        function sendMessage() {
            if (!AppState.currentChat || !AppState.currentUser) return;
            
            const input = document.getElementById('messageInput');
            const content = input.value.trim();
            
            if (content) {
                const message = {
                    id: AppState.messages.length + 1,
                    from: AppState.currentUser.id,
                    to: AppState.currentChat,
                    content: content,
                    timestamp: new Date(),
                    read: false
                };
                
                AppState.messages.push(message);
                AppState.currentUser.messagesCount++;
                input.value = '';
                
                // Save to localStorage
                saveAppState();
                
                // Show message alert for recipient (simulate receiving message)
                const recipient = AppState.users.find(u => u.id === AppState.currentChat);
                if (recipient) {
                    showMessageAlert(AppState.currentUser, content);
                }
                
                openChat(AppState.currentChat);
                updateUserInterface();
            }
        }

        // Gallery Management
        function loadGallery() {
            if (!AppState.currentUser) return;
            
            loadGallerySection('publicGallery', false);
            loadGallerySection('privateGallery', true);
        }

        function loadGallerySection(containerId, isPrivate) {
            const container = document.getElementById(containerId);
            const userImages = AppState.gallery.filter(img => 
                img.userId === AppState.currentUser.id && img.isPrivate === isPrivate
            );
            
            // Keep upload placeholder and add images
            const placeholder = container.querySelector('.upload-placeholder');
            container.innerHTML = '';
            container.appendChild(placeholder);
            
            userImages.forEach(image => {
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.onclick = () => openImageModal(image.id);
                
                item.innerHTML = `
                    <img src="${image.imageUrl}" alt="${image.caption}">
                    <div class="overlay">
                        <div>👁️ צפה</div>
                    </div>
                `;
                
                container.appendChild(item);
            });
        }

        function uploadImage(type) {
            if (!AppState.currentUser) {
                showNotification('אנא התחבר כדי להעלות תמונות', 'error');
                return;
            }
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const caption = prompt('הוסף תיאור לתמונה:') || 'תמונה חדשה';
                        
                        const newImage = {
                            id: AppState.gallery.length + 1,
                            userId: AppState.currentUser.id,
                            imageUrl: e.target.result,
                            caption: caption,
                            isPrivate: type === 'private',
                            timestamp: new Date()
                        };
                        
                        AppState.gallery.push(newImage);
                        saveAppState(); // Save to localStorage
                        loadGallery();
                        showNotification(`תמונה ${type === 'private' ? 'פרטית' : 'ציבורית'} הועלתה בהצלחה!`);
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function uploadProfileImage() {
            if (!AppState.currentUser) return;
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        AppState.currentUser.profileImage = e.target.result;
                        saveAppState(); // Save to localStorage
                        updateUserInterface();
                        showNotification('תמונת הפרופיל עודכנה בהצלחה!');
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        // Modal Management
        function openImageModal(imageId) {
            const image = AppState.gallery.find(img => img.id === imageId);
            if (!image) return;
            
            const user = AppState.users.find(u => u.id === image.userId);
            const modal = document.getElementById('imageModal');
            const content = document.getElementById('imageModalContent');
            
            content.innerHTML = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <img src="${image.imageUrl}" style="max-width: 100%; max-height: 400px; border-radius: 15px;">
                </div>
                <div>
                    <h3 style="color: var(--primary-gold); margin-bottom: 10px;">${user.username}</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">${image.caption}</p>
                    <p style="color: var(--text-muted); font-size: 14px;">${formatTimestamp(image.timestamp)}</p>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        function requestPrivateAccess(userId) {
            const user = AppState.users.find(u => u.id === userId);
            if (!user) return;
            
            const modal = document.getElementById('privateAccessModal');
            const text = document.getElementById('privateAccessText');
            
            text.textContent = `האם ברצונך לשלוח בקשה לצפייה בתמונות הפרטיות של ${user.username}?`;
            modal.style.display = 'block';
            
            // Store current target user
            modal.dataset.targetUserId = userId;
        }

        function sendPrivateAccessRequest() {
            const modal = document.getElementById('privateAccessModal');
            const userId = parseInt(modal.dataset.targetUserId);
            const user = AppState.users.find(u => u.id === userId);
            
            if (user) {
                showNotification(`בקשה לצפייה בתמונות פרטיות נשלחה ל${user.username}`);
                closeModal('privateAccessModal');
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Admin Panel
        function loadAdminPanel() {
            if (!AppState.isAdmin) return;
            
            // Update statistics
            document.getElementById('totalUsers').textContent = AppState.users.filter(u => u.type !== 'admin').length;
            document.getElementById('totalSugarDaddies').textContent = AppState.users.filter(u => u.type === 'sugar_daddy').length;
            document.getElementById('totalSugarBabies').textContent = AppState.users.filter(u => u.type === 'sugar_baby').length;
            document.getElementById('totalMessages').textContent = AppState.messages.length;
            
            // Load users list
            const container = document.getElementById('usersList');
            container.innerHTML = '';
            
            AppState.users.filter(u => u.type !== 'admin').forEach(user => {
                const row = document.createElement('div');
                row.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid var(--border-color);';
                
                row.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="profile-avatar" style="width: 50px; height: 50px; font-size: 16px;">
                            ${user.profileImage ? `<img src="${user.profileImage}">` : user.username[0].toUpperCase()}
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 5px;">
                                ${user.username}
                                ${user.verified ? '<span class="badge badge-verified" style="margin-left: 10px;">✓</span>' : ''}
                                ${user.premium ? '<span class="badge badge-premium" style="margin-left: 5px;">★</span>' : ''}
                            </div>
                            <div style="font-size: 13px; color: var(--text-secondary);">
                                ${user.email} • ${user.type === 'sugar_daddy' ? 'שוגר דדי' : 'שוגר בייב'} • ${user.location}
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn" style="padding: 8px 15px; font-size: 13px;" onclick="verifyUser(${user.id})">אמת</button>
                        <button class="btn btn-outline" style="padding: 8px 15px; font-size: 13px;" onclick="blockUser(${user.id})">חסום</button>
                    </div>
                `;
                
                container.appendChild(row);
            });
        }

        function verifyUser(userId) {
            const user = AppState.users.find(u => u.id === userId);
            if (user) {
                user.verified = true;
                saveAppState(); // Save to localStorage
                showNotification(`המשתמש ${user.username} אומת בהצלחה`);
                loadAdminPanel();
            }
        }

        function blockUser(userId) {
            const userIndex = AppState.users.findIndex(u => u.id === userId);
            if (userIndex !== -1) {
                const username = AppState.users[userIndex].username;
                AppState.users.splice(userIndex, 1);
                saveAppState(); // Save to localStorage
                showNotification(`המשתמש ${username} נחסם`);
                loadAdminPanel();
            }
        }

        function exportUsers() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "שם,אימייל,סוג,גיל,מיקום,מאומת,פרימיום\n" +
                AppState.users.filter(u => u.type !== 'admin').map(u => 
                    `${u.username},${u.email},${u.type === 'sugar_daddy' ? 'שוגר דדי' : 'שוגר בייב'},${u.age},${u.location},${u.verified ? 'כן' : 'לא'},${u.premium ? 'כן' : 'לא'}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "luxe_users_export.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('נתוני המשתמשים יוצאו בהצלחה');
        }

        function showReports() {
            showNotification('דוחות מפורטים יהיו זמינים בגרסה הבאה');
        }

        function manageReports() {
            showNotification('ניהול דיווחים יהיה זמין בגרסה הבאה');
        }

        // Verification System
        function startVerification() {
            document.getElementById('verificationModal').style.display = 'block';
        }

        function submitVerification() {
            const input = document.getElementById('verificationImage');
            if (input.files.length > 0) {
                showNotification('בקשת האימות נשלחה לבדיקה. נעדכן אותך בהקדם.');
                closeModal('verificationModal');
            } else {
                showNotification('אנא בחר תמונה לאימות', 'error');
            }
        }

        // Filter System
        function applyFilters() {
            if (!AppState.currentUser) return;
            
            const userTypeFilter = document.getElementById('userTypeFilter').value;
            const minAge = parseInt(document.getElementById('minAge').value) || 0;
            const maxAge = parseInt(document.getElementById('maxAge').value) || 99;
            const locationFilter = document.getElementById('locationFilter').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            
            let filteredUsers = AppState.users.filter(user => 
                user.id !== AppState.currentUser.id && user.type !== 'admin'
            );
            
            if (userTypeFilter) {
                filteredUsers = filteredUsers.filter(user => user.type === userTypeFilter);
            }
            
            if (minAge > 0) {
                filteredUsers = filteredUsers.filter(user => user.age >= minAge);
            }
            
            if (maxAge < 99) {
                filteredUsers = filteredUsers.filter(user => user.age <= maxAge);
            }
            
            if (locationFilter) {
                filteredUsers = filteredUsers.filter(user => 
                    user.location.toLowerCase().includes(locationFilter)
                );
            }
            
            if (statusFilter === 'online') {
                filteredUsers = filteredUsers.filter(user => user.online);
            } else if (statusFilter === 'verified') {
                filteredUsers = filteredUsers.filter(user => user.verified);
            } else if (statusFilter === 'premium') {
                filteredUsers = filteredUsers.filter(user => user.premium);
            }
            
            // Update profiles display
            const container = document.getElementById('profilesContainer');
            container.innerHTML = '';
            
            if (filteredUsers.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 50px; color: var(--text-muted);"><h3>לא נמצאו תוצאות</h3><p>נסה לשנות את קריטריוני החיפוש</p></div>';
            } else {
                filteredUsers.forEach(user => {
                    const card = createProfileCard(user);
                    container.appendChild(card);
                });
            }
        }

        // Message Alert System
        function showMessageAlert(sender, messageContent) {
            // Don't show alert if user is currently in this chat
            if (AppState.currentChat === sender.id && 
                document.getElementById('messages').classList.contains('active')) {
                return;
            }
            
            const alert = document.getElementById('messageAlert');
            const alertAvatar = document.getElementById('alertAvatar');
            const alertAvatarImg = document.getElementById('alertAvatarImg');
            const alertAvatarText = document.getElementById('alertAvatarText');
            const alertSenderName = document.getElementById('alertSenderName');
            const alertMessageText = document.getElementById('alertMessageText');
            
            // Store sender ID for opening chat
            AppState.currentAlertSender = sender.id;
            
            // Update alert content
            alertSenderName.textContent = sender.username;
            alertMessageText.textContent = messageContent.length > 50 ? 
                messageContent.substring(0, 50) + '...' : messageContent;
            
            // Update avatar
            if (sender.profileImage) {
                alertAvatarImg.src = sender.profileImage;
                alertAvatarImg.style.display = 'block';
                alertAvatarText.style.display = 'none';
            } else {
                alertAvatarText.textContent = sender.username[0].toUpperCase();
                alertAvatarImg.style.display = 'none';
                alertAvatarText.style.display = 'block';
            }
            
            // Show alert
            alert.classList.add('show');
            
            // Auto dismiss after 5 seconds
            setTimeout(() => {
                dismissAlert();
            }, 5000);
        }

        function openAlertChat() {
            if (AppState.currentAlertSender) {
                dismissAlert();
                startChat(AppState.currentAlertSender);
            }
        }

        function dismissAlert() {
            const alert = document.getElementById('messageAlert');
            alert.classList.remove('show');
            AppState.currentAlertSender = null;
        }

        // Utility Functions
        function formatTimestamp(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 60) return `לפני ${minutes} דקות`;
            if (hours < 24) return `לפני ${hours} שעות`;
            return `לפני ${days} ימים`;
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Initialize immediately (before DOM ready)
        console.log('🚀 LUXE Platform Starting...');
        
        // Load data immediately
        if (typeof(Storage) !== "undefined") {
            loadAppState();
            console.log('📊 Initial users loaded:', AppState.users.length);
            
            // Make functions available immediately
            window.devLogin = function(type) {
                console.log('Dev login called with type:', type);
                
                const emails = {
                    'daddy': 'david@luxe.com',
                    'baby': 'maya@luxe.com', 
                    'premium': 'alex@luxe.com',
                    'admin': 'admin@luxe.com'
                };
                
                if (emails[type]) {
                    console.log('Using email:', emails[type]);
                    demoLogin(emails[type]);
                } else {
                    console.log('Available types: daddy, baby, premium, admin');
                    console.log('Available emails:', emails);
                }
            };
            
            window.forceAdminLogin = function() {
                ensureAdminExists();
                const admin = AppState.users.find(u => u.type === 'admin');
                if (admin) {
                    AppState.currentUser = admin;
                    AppState.isAdmin = true;
                    saveAppState();
                    updateUserInterface();
                    showSection('admin');
                    showNotification('התחברת כמנהל מערכת!');
                    console.log('Force admin login successful');
                } else {
                    console.error('Could not create admin user');
                }
            };
            
            window.quickLogin = function() {
                console.log('🚀 Quick Login Options:');
                console.log('Type one of these commands:');
                console.log('devLogin("admin")   - 🛠️ Admin');
                console.log('devLogin("daddy")   - 👨‍💼 Sugar Daddy');  
                console.log('devLogin("baby")    - ✨ Sugar Baby');
                console.log('devLogin("premium") - 💎 Premium User');
                console.log('\nOr use: forceAdminLogin() for emergency admin access');
            };
            
            // Show immediate help
            setTimeout(() => {
                console.log('💡 Ready! Type quickLogin() for help or devLogin("admin") to login as admin');
            }, 100);
        }

        // Form Handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Registration form
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (!AppState.selectedUserType) {
                    showNotification('אנא בחר סוג משתמש', 'error');
                    return;
                }
                
                const formData = new FormData(e.target);
                const userData = {
                    id: AppState.users.length + 1,
                    username: formData.get('username'),
                    email: formData.get('email'),
                    type: AppState.selectedUserType,
                    age: parseInt(formData.get('age')),
                    location: formData.get('location'),
                    bio: formData.get('bio'),
                    verified: false,
                    premium: false,
                    online: true,
                    profileViews: 0,
                    messagesCount: 0,
                    joinDate: new Date()
                };
                
                // Add type-specific fields
                if (AppState.selectedUserType === 'sugar_daddy') {
                    userData.profession = formData.get('profession');
                    userData.expectations = formData.get('expectations');
                    userData.lifestyle = formData.get('lifestyle');
                } else {
                    userData.aspirations = formData.get('aspirations');
                    userData.offering = formData.get('offering');
                    userData.support_expectations = formData.get('support_expectations');
                }
                
                AppState.users.push(userData);
                AppState.currentUser = userData;
                
                saveAppState(); // Save to localStorage
                updateUserInterface();
                showSection('discover');
                showNotification('ברוך הבא לקהילת LUXE!');
            });

            // Login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                console.log('=== LOGIN FORM SUBMITTED ===');
                
                const formData = new FormData(e.target);
                const email = formData.get('email');
                const password = formData.get('password');
                
                console.log('Login attempt with email:', email);
                console.log('Available users:', AppState.users.length);
                console.log('User emails:', AppState.users.map(u => u.email));
                
                const user = AppState.users.find(u => u.email === email);
                console.log('Found user:', user);
                
                if (user) {
                    AppState.currentUser = user;
                    AppState.isAdmin = (user.type === 'admin');
                    console.log('Setting current user:', user.username, 'Is admin:', AppState.isAdmin);
                    
                    saveAppState(); // Save to localStorage
                    updateUserInterface();
                    
                    if (AppState.isAdmin) {
                        showSection('admin');
                        showNotification(`ברוך השב מנהל המערכת!`);
                    } else {
                        showSection('discover');
                        showNotification(`ברוך השב ${user.username}!`);
                    }
                    
                    console.log('Login successful!');
                } else {
                    console.error('User not found for email:', email);
                    console.log('Creating user list for debug:');
                    AppState.users.forEach((u, index) => {
                        console.log(`${index}: ${u.email} (${u.type})`);
                    });
                    showNotification('פרטי התחברות שגויים - אימייל לא נמצא', 'error');
                }
            });

            // Profile form
            document.getElementById('profileForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (!AppState.currentUser) return;
                
                const formData = new FormData(e.target);
                AppState.currentUser.username = formData.get('username');
                AppState.currentUser.bio = formData.get('bio');
                AppState.currentUser.location = formData.get('location');
                
                saveAppState(); // Save to localStorage
                updateUserInterface();
                showNotification('הפרופיל עודכן בהצלחה!');
            });

            // Message input
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Developer shortcuts (hidden)
            document.addEventListener('keydown', function(e) {
                // Ctrl + Shift + D for developer login menu
                if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                    e.preventDefault();
                    const type = prompt('Dev Login:\ndaddy - שוגר דדי\nbaby - שוגר בייב\npremium - פרימיום\nadmin - מנהל\n\nבחר סוג:');
                    if (type) {
                        window.devLogin(type);
                    }
                }
                
                // Ctrl + Shift + C for clearing data
                if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                    e.preventDefault();
                    window.clearAppData();
                }
            });

            // Load app state and initialize
            loadAppState();
            updateStorageStatus();
            
            // Show storage info in console
            console.log('🗄️ Local Storage Status:');
            console.log('Users:', Storage.load(Storage.keys.users, []).length);
            console.log('Messages:', Storage.load(Storage.keys.messages, []).length);
            console.log('Gallery:', Storage.load(Storage.keys.gallery, []).length);
            console.log('Current User:', Storage.load(Storage.keys.currentUser) ? 'Logged in' : 'Not logged in');
            console.log('💡 Development Commands:');
            console.log('- devLogin("admin") - Login as admin');
            console.log('- devLogin("daddy") - Login as sugar daddy');
            console.log('- devLogin("baby") - Login as sugar baby');
            console.log('- forceAdminLogin() - Emergency admin login');
            console.log('- clearAppData() - Clear all data');
            console.log('- showStorageInfo() - Detailed storage info');
            console.log('- Ctrl+Shift+D - Login menu');
            console.log('- Ctrl+Shift+C - Clear data');
            
            // Debug: List all users
            setTimeout(() => {
                console.log('📋 All Users Available:');
                AppState.users.forEach(user => {
                    console.log(`- ${user.email} (${user.type}) - ${user.username}`);
                });
            }, 500);
        });

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        };
    </script>
</body>
</html>